{% extends 'core/base.html' %}
{% load static %}

{% block title %}Painel do Superusuário{% endblock %}
{% block header_title %}Painel do Superusuário{% endblock %}

{% block user_info %}
  <span>Olá, <a href="{% url 'editar_perfil_super' %}" title="Editar Perfil">{{ request.user.get_full_name|default:request.user.username }}</a></span>
  <a href="{% url 'editar_perfil_super' %}" title="Editar Perfil"><i class="fas fa-user"></i></a>
  <a href="{% url 'painel_super' %}" title="Voltar ao Painel"><i class="fas fa-arrow-left"></i></a>
  <a href="{% url 'logout' %}" title="Sair"><i class="fas fa-power-off"></i></a>
{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'core/css/lista_discentes.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}

{% block content %}
<div class="container">

  <!-- Topo com botão e busca -->
  <div class="top-controls">
    <a href="{% url 'cadastrar_turma' %}">
      <button class="cadastrar-btn">
        <i class="fas fa-book"></i>
        Cadastrar Turma
      </button>
    </a>

    <form class="buscar-form-container" method="get" action="{% url 'listar_turmas' %}">
      <input type="text" class="buscar-input" name="q" placeholder="Buscar turma..." value="{{ query|default:'' }}">
      <button type="submit" class="buscar-btn">
        <i class="fas fa-search"></i>
      </button>
    </form>
  </div>

  <!-- Filtro por ano letivo -->
  <form method="get" style="margin-bottom: 20px;">
    <label><strong>Ano letivo:</strong></label>
    <select name="ano" onchange="this.form.submit()" style="padding: 5px;">
      {% for ano in anos_disponiveis %}
        <option value="{{ ano }}" {% if ano == ano_filtro %}selected{% endif %}>
          {{ ano }}
        </option>
      {% endfor %}
    </select>

    {% if query %}
      <input type="hidden" name="q" value="{{ query }}">
    {% endif %}
  </form>

  <!-- Conteúdo principal -->
  <div class="content-box">
    <h2 class="titulo">TURMAS CADASTRADAS</h2>

    <table class="tabela-discentes">
      <thead>
        <tr class="tabela-principal">
          <th class="tabela-cabecalho">NOME</th>
          <th class="tabela-cabecalho">TURNO</th>
          <th class="tabela-cabecalho">AÇÕES</th>
        </tr>
      </thead>
      <tbody>
        {% for turma in turmas %}
          <tr class="linhas-tabela">
            <td class="tabela-info">{{ turma.nome }}</td>
            <td class="tabela-info">{{ turma.get_turno_display }}</td>

            <td class="tabela-icones">
              <a href="{% url 'listar_disciplinas_turma' turma.id %}"
                class="action-btn adicionar"
                title="Ver Disciplinas da Turma">
                  <i class="fas fa-book-medical"></i>
              </a>
            </td>
          </tr>
        {% empty %}
          <tr class="linhas-tabela">
            <td class="tabela-info" colspan="3">Nenhuma turma encontrada.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

  </div>

</div>
{% endblock %}
